# 待实现功能清单

> Kigo Node.js 相对于 Claude Code 尚未实现的功能

---

## 概述

本文档记录了 Kigo Node.js 项目相对于 Claude Code 尚未实现的核心功能，供后期规划和开发参考。

---

## 功能对比总览

| 功能 | Claude Code | Kigo Node.js | 优先级 |
|------|-------------|---------------|--------|
| 代理系统（Task） | ✅ | ❌ | 高 |
| 计划模式 | ✅ | ❌ | 高 |
| 用户交互工具 | ✅ | ❌ | 高 |
| IDE 集成 | ✅ | ❌ | 中 |
| 权限控制系统 | ✅ | ❌ | 高 |
| 沙盒环境 | ✅ | ❌ | 中 |
| Hooks 系统 | ✅ | ❌ | 中 |
| 多模态文件分析 | ✅ | ❌ | 低 |
| Jupyter 笔记本 | ✅ | ❌ | 低 |
| 扩展思考模式 | ✅ | ❌ | 低 |
| 结构化输出 | ✅ | ❌ | 低 |
| 工具搜索 | ✅ | ❌ | 中 |

---

## 1. 代理系统（Task 工具）

### 功能描述

Claude Code 的 Task 工具允许启动专门的子代理来处理不同类型的复杂任务，实现任务并行化和专业化处理。

### 子代理类型

- **general-purpose**: 通用代理，负责复杂、多步骤的任务
- **Explore**: 快速探索代码库，查找文件和代码模式
- **Plan**: 软件架构代理，设计实现方案
- **claude-code-guide**: 回答关于 Claude Code 本身的问题
- **statusline-setup**: 配置状态行设置

### 关键特性

- 支持后台运行 (run_in_background)
- 支持恢复已完成的代理 (resume 参数)
- 独立的上下文和历史记录
- 并行执行多个任务
- 任务输出检索 (TaskOutput 工具)

### 实现要点

1. 创建代理工厂和管理器
2. 支持多种代理类型的注册
3. 实现代程间通信机制
4. 任务生命周期管理
5. 输出捕获和检索

---

## 2. 计划模式（Plan Mode）

### 功能描述

EnterPlanMode / ExitPlanMode 工具实现在执行任务前先探索代码库、设计方案，用户确认后再实施。

### 工作流程

1. 触发计划模式（用户或系统自动触发）
2. 进入只读探索阶段（只能使用读取类工具）
3. 设计实现方案
4. 用户审查和确认方案
5. 退出计划模式，执行实施

### 关键特性

- 只读约束（禁止修改操作）
- 计划文件生成
- 用户确认机制
- 与代理系统配合工作

---

## 3. 用户交互工具（AskUserQuestion）

### 功能描述

向用户提问以获取澄清、收集偏好信息或让用户在多个选项中选择。

### 功能特性

- 单选/多选问题
- 自定义文本输入（Other 选项）
- 问题描述和选项说明
- Header 标签显示

### 使用场景

- 澄清模糊的需求
- 选择实现方式
- 确认关键决策
- 收集配置信息

---

## 4. IDE 集成

### 功能描述

VS Code / JetBrains 等原生 IDE 插件集成。

### 核心功能

- 代码引用可点击跳转
- 文件预览和打开
- 选中上下文传入
- 状态栏集成
- 命令面板集成

### 实现路径

- VS Code Extension API
- JetBrains Plugin SDK
- 统一的 IDE 适配层

---

## 5. 权限控制系统

### 功能描述

细粒度的命令和工具权限控制。

### 功能特性

- 允许列表（allow）
- 阻止列表（block）
- DontAsk 模式（自动拒绝高风险操作）
- 临时权限提升
- 权限审计日志

### 配置示例

```json
{
  "permissions": {
    "allow": [
      "Bash(npm run build)",
      "Bash(pnpm build)"
    ],
    "block": [
      "Bash(rm -rf *)"
    ],
    "dontAsk": false
  }
}
```

---

## 6. 沙盒环境

### 功能描述

安全的执行环境隔离系统。

### 安全特性

- 工作目录隔离
- 命令执行上下文重置
- 文件访问限制
- 网络访问控制
- 资源使用限制

---

## 7. Hooks 系统

### 功能描述

在特定事件触发时执行自定义逻辑。

### Hook 类型

- **Pre-hooks**: 工具调用前触发
- **Post-hooks**: 工具调用后触发
- **User-prompt-submit-hook**: 用户提交提示时触发

### 使用场景

- 代码审查自动化
- 执行前的安全检查
- 执行后的清理工作
- 自定义工作流编排

---

## 8. 多模态文件分析

### 功能描述

支持图片和 PDF 文件的分析。

### 功能特性

- 图片内容读取和描述
- PDF 文件解析（文本和视觉内容）
- Jupyter 笔记本解析

### 技术要求

- Claude Vision API
- PDF 解析库（如 pdf-parse）
- 多模态模型支持

---

## 9. Jupyter 笔记本支持

### 功能描述

专门的 Jupyter 笔记本操作工具。

### 功能特性

- 读取单元格
- 编辑单元格（replace/insert/delete）
- 执行代码和输出展示
- 保存笔记本

---

## 10. 扩展思考模式

### 功能描述

模型在进行工具调用前进行深层思考。

### 功能特性

- 启用/禁用开关
- 思考过程共享
- 与特定模型配合使用

---

## 11. 结构化输出

### 功能描述

强制模型返回 JSON 等结构化数据。

### 功能特性

- Schema 定义（Zod）
- 输出验证
- 重试机制

---

## 12. 工具搜索

### 功能描述

动态搜索和发现可用工具。

### 功能特性

- 工具名称搜索
- 工具描述搜索
- 分类浏览

---

## 开发建议

### 第一阶段（高优先级）

1. **权限控制系统** - 安全基础
2. **用户交互工具** - 提升用户体验
3. **代理系统框架** - 核心基础设施

### 第二阶段（中优先级）

4. 计划模式
5. Hooks 系统
6. IDE 集成基础

### 第三阶段（低优先级）

7. 多模态支持
8. Jupyter 支持
9. 扩展思考模式

---

## 参考资源

- Claude Code 官方文档: https://code.claude.com/docs
- Claude API 文档: https://platform.anthropic.com/docs
- MCP 协议规范: https://modelcontextprotocol.io